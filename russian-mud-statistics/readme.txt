Hi, All!

Это набор скриптов и плагинов для munin, которые собирают статистику русских мадов и
выводят ее в виде графиков. Работают скрипты в Linux

Сами плагины для системы munin находятся в подкаталоге munin-plugins

В основном каталоге находятся скрипты. Основных скриптов два

dododo.sh и do30min.sh

Оба скрипта надо запустить, чтобы они постоянно работали.
Лично я в отладочных целях запускаю каждый скрипт в отдельном окне screen,
но можно запускать в фоновом режиме их примерно так

nohup ./dododo.sh > /dev/null &

Скрипт dododo работает с периодом в 5 минут, скрипт do30min с периодом в 30 минут.
30-минутный скрипт для сделан для тех мадов, админы которых просили не слишком часто дергать мад.
Впрочем, пятиминутность нафиг не нужна и можно было бы все мады засунуть в 30-минутный цикл
и было бы нормально.

Некоторые мады выдают свою статистику на своем сайте, плагин для munin ее парсит.

Для других мадов пришлось там зарегистрировать персонажа, и написать скрипт для мад-клиента
tintin++. По скрипту мой персонаж входит, дает команду КТО или WHO и выходит. Потом вывод этой
команды парсится. Нужно использовать мою модификацию tintin++, в которой есть команда
#proolwatchdogtimer. Эта модификация есть здесь: https://github.com/prool/virtustan

Зачем это надо. Посмотрите на мои скрипты - scr.* - они примитивнейшие. Шаг влево, шаг вправо и
они зависают в ожидании строки, которой никогда не будет (мад не отвечает, персонажа отчатили,
мад тормозит, временно пропало соединение, еще что-нибудь) и тогда вся система сбора статистики
зависает о начинает рисовать на графике горизонтальные линии. А с таймером тинтин в любом случае
завершит работу через 5 минут. И на следующем цикле этот мад скорее всего ответит (мои скрипты
крутятся уже несколько недель и основные возможные сбойные ситуации я уже встречал и на них
отладился).

Вот, кстати, мой сайт, где представлена статистика, собираемая моими скриптами

http://muds.kharkov.org

Кроме того, для работы скриптов используются написанные на C четыре фильтра (исполняемые файлы
filtr[1-4], исходники filtr[1-4].c). Я написал их на С потому, что плохо знаю awk и совсем
не знаю perl. Для их компиляции надо набрать команду make

Вот вроде и все

Будут вопросы или пожелания, пишите

Пруль

17 апреля 2017 года

proolix@gmail.com

Харьков

---

Примечание. Слово fuck в скриптах нужно. Без него не работает, проверьте. Хотя там может быть
любая строка
